# 第二章

## 2.2 Web 与 HTTP

### web

+ web页由对象组成，对象可以是HTML文件、JPEG图像、JAVA小程序、声音剪辑文件等

+ Web页含有一个基本的HTML文件，该文件包含若干文件对象的引用，图片也是链接下载，浏览器运用，对象指对象

+ 通过URL对每个对象进行引用，URL：协议://用户：口令@主机名/路径名：port（端口），用户口令可以匿名，port默认

### HTTP:超文本传输协议

+ web的应用层协议

+ 服务端客户端模式

+ 使用TCP协议

+ 80端口，无状态

### 服务器socket为守候socket，每有一个连接请求，就新生成一个socket为服务端与新客户端的通信socket

### 客户端获得html文件（数据体），每遇到一个链接（图片等），再建立链接，发送请求，服务端发送图片

### http1.1长连接

### 非流水线：一个时刻只生产一辆汽车，一个请求的相应回来，再发第二个，流水线：都是发送到一个URL，前一个请求未回来，就发第二个，一个流水现有多个汽车在制造

### HTTP请求报文（ASCII）,换行回车符，表示报文结束

+ 请求头，首部行：Host, User-agent,Connection Accept-language ![HTTP请求通用格式](Picture\HTTP请求通用格式.png)

+ 可用过URL请求行字段进行上载，html也分头部和body![请求报文方法类型](Picture\请求报文分类.png)

### HTTP响应报文，content-length用于客户端数据解析，因为使用TCP这些传输层协议需要应用层自己规定传输的界限

### Cookie：客户端与服务器维护状态

+ 第一次连接服务器会生成cookie并将cookie发给客户端同时保存下来，客户端收到cookie也保存下来，下次向这个网站发消息时会带上cookie
+ HTTP响应报文和请求报文都有cookie头![Cookie](Picture\Cookie.png)

### Web缓存（代理服务器），即是客户端也是服务端，搭配If modified since搭配使用，如果第二次发送条件GET方法 ，没改发送一个304头部即可

+ 缓存命中直接返回
+ 缓存不命中发送请求到origin服务器，再返回

#### 使用原因

+ 降低客户端请求响应时间
+ 可以减少一个机构内部网络与Internet接入链路上的流量
+ 大量缓存使较弱的ICP也能提供有效内容

#### 流量强度 = I实际 / I理论 排队延时 = I / 1 - I * L(数据长度) / R(Mbps)